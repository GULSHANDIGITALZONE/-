<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Faisla Karo - Decision Maker</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;800&display=swap');
        
        body {
            font-family: 'Poppins', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            touch-action: manipulation;
        }

        .wheel-container {
            position: relative;
            width: 300px;
            height: 300px;
            margin: 0 auto;
            transition: transform 3s cubic-bezier(0.17, 0.67, 0.12, 0.99); 
            /* This bezier curve creates a realistic deceleration */
        }

        /* The pointer arrow */
        .arrow {
            position: absolute;
            top: -20px;
            left: 50%;
            transform: translateX(-50%);
            width: 0; 
            height: 0; 
            border-left: 20px solid transparent;
            border-right: 20px solid transparent;
            border-top: 40px solid #FF5722;
            z-index: 10;
            filter: drop-shadow(0 4px 6px rgba(0,0,0,0.3));
        }

        .canvas-wrapper {
            width: 100%;
            height: 100%;
            border-radius: 50%;
            border: 8px solid white;
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
            overflow: hidden;
            position: relative;
        }

        canvas {
            width: 100%;
            height: 100%;
            display: block;
        }

        /* Center Hub */
        .center-circle {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 50px;
            height: 50px;
            background: white;
            border-radius: 50%;
            z-index: 5;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            color: #764ba2;
            box-shadow: inset 0 2px 4px rgba(0,0,0,0.1);
        }

        .modal {
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(5px);
        }

        .bounce-in {
            animation: bounceIn 0.8s;
        }

        @keyframes bounceIn {
            0% { transform: scale(0.3); opacity: 0; }
            50% { transform: scale(1.05); opacity: 1; }
            70% { transform: scale(0.9); }
            100% { transform: scale(1); }
        }
    </style>
</head>
<body class="min-h-screen flex flex-col items-center justify-center text-white pb-10">

    <!-- Header -->
    <header class="text-center mb-6 mt-8">
        <h1 class="text-4xl font-extrabold text-transparent bg-clip-text bg-gradient-to-r from-yellow-300 to-pink-500 drop-shadow-sm">
            Faisla Karo
        </h1>
        <p class="text-gray-200 text-sm mt-1 opacity-90">Confused? Spin the wheel!</p>
    </header>

    <!-- Main App Area -->
    <div class="w-full max-w-md px-4 flex flex-col items-center gap-8">
        
        <!-- Wheel Section -->
        <div class="relative">
            <div class="arrow"></div>
            <div class="wheel-container" id="wheelContainer">
                <div class="canvas-wrapper">
                    <canvas id="wheelCanvas" width="600" height="600"></canvas>
                </div>
                <div class="center-circle"><i class="fas fa-star"></i></div>
            </div>
        </div>

        <!-- Controls -->
        <div class="w-full flex flex-col gap-4">
            <button id="spinBtn" class="w-full py-4 bg-yellow-400 hover:bg-yellow-300 text-purple-900 font-black text-xl rounded-2xl shadow-[0_6px_0_rgb(180,83,9)] active:shadow-none active:translate-y-1 transition-all uppercase tracking-wider">
                Ghumao! (Spin)
            </button>
            
            <!-- Quick Presets -->
            <div class="flex gap-2 justify-center overflow-x-auto pb-2 scrollbar-hide">
                <button onclick="loadPreset('food')" class="px-3 py-1 bg-white/10 rounded-full text-xs hover:bg-white/20 whitespace-nowrap border border-white/20">üçî Khana (Food)</button>
                <button onclick="loadPreset('movies')" class="px-3 py-1 bg-white/10 rounded-full text-xs hover:bg-white/20 whitespace-nowrap border border-white/20">üé¨ Movies</button>
                <button onclick="loadPreset('activity')" class="px-3 py-1 bg-white/10 rounded-full text-xs hover:bg-white/20 whitespace-nowrap border border-white/20">üéÆ Fun</button>
            </div>

            <!-- Input Area -->
            <div class="bg-white/10 backdrop-blur-sm rounded-xl p-4 border border-white/10">
                <div class="flex justify-between items-center mb-2">
                    <h3 class="font-bold text-sm text-yellow-300">Options (Edit karo)</h3>
                    <button id="clearBtn" class="text-xs text-red-300 hover:text-white underline">Clear All</button>
                </div>
                <textarea id="optionsInput" class="w-full bg-black/20 text-white rounded-lg p-3 text-sm focus:outline-none focus:ring-2 focus:ring-yellow-400 placeholder-gray-400 h-24 resize-none" placeholder="Enter options here (separated by comma or new line)...">Pizza, Burger, Biryani, Salad, Maggi, Dosa</textarea>
                <button id="updateBtn" class="w-full mt-2 py-2 bg-purple-600 hover:bg-purple-500 rounded-lg text-sm font-semibold transition-colors">
                    Update Wheel
                </button>
            </div>
        </div>
    </div>

    <!-- Winner Modal -->
    <div id="resultModal" class="modal fixed inset-0 z-50 hidden flex items-center justify-center px-4">
        <div class="bg-white text-gray-800 rounded-3xl p-8 max-w-sm w-full text-center shadow-2xl relative transform transition-all">
            <button id="closeModal" class="absolute top-4 right-4 text-gray-400 hover:text-gray-600">
                <i class="fas fa-times text-xl"></i>
            </button>
            
            <div class="w-20 h-20 bg-yellow-100 rounded-full flex items-center justify-center mx-auto mb-4 text-4xl">
                üéâ
            </div>
            
            <h2 class="text-2xl font-bold text-gray-800 mb-2">Aaj ka Faisla!</h2>
            <p class="text-gray-500 text-sm mb-4">You should go with:</p>
            
            <div id="winnerText" class="text-3xl font-black text-purple-600 mb-6 break-words">
                Biryani
            </div>
            
            <button onclick="document.getElementById('resultModal').classList.add('hidden')" class="w-full py-3 bg-gray-900 text-white rounded-xl font-semibold hover:bg-gray-800">
                Cool, Thanks!
            </button>
        </div>
    </div>

    <script>
        // DOM Elements
        const canvas = document.getElementById('wheelCanvas');
        const ctx = canvas.getContext('2d');
        const wheelContainer = document.getElementById('wheelContainer');
        const spinBtn = document.getElementById('spinBtn');
        const optionsInput = document.getElementById('optionsInput');
        const updateBtn = document.getElementById('updateBtn');
        const resultModal = document.getElementById('resultModal');
        const winnerText = document.getElementById('winnerText');
        const closeModal = document.getElementById('closeModal');
        const clearBtn = document.getElementById('clearBtn');

        // State
        let items = [];
        let currentRotation = 0;
        let isSpinning = false;
        
        // Vibrant Colors for segments
        const colors = [
            '#FF6B6B', '#4ECDC4', '#45B7D1', '#96CEB4', 
            '#FFEEAD', '#D4A5A5', '#9B59B6', '#3498DB',
            '#E67E22', '#2ECC71', '#F1C40F', '#E74C3C'
        ];

        // Init
        function init() {
            parseInput();
            drawWheel();
        }

        // Parse Textarea
        function parseInput() {
            const rawText = optionsInput.value;
            // Split by comma or newline, trim whitespace, remove empty strings
            items = rawText.split(/,|\n/).map(i => i.trim()).filter(i => i !== "");
            
            if (items.length === 0) {
                items = ["Option A", "Option B"]; // Fallback
            }
        }

        // Draw the Wheel
        function drawWheel() {
            const width = canvas.width;
            const height = canvas.height;
            const centerX = width / 2;
            const centerY = height / 2;
            const radius = width / 2;
            const step = (2 * Math.PI) / items.length;

            ctx.clearRect(0, 0, width, height);

            items.forEach((item, index) => {
                const startAngle = index * step;
                const endAngle = startAngle + step;

                // Draw Slice
                ctx.beginPath();
                ctx.moveTo(centerX, centerY);
                ctx.arc(centerX, centerY, radius, startAngle, endAngle);
                ctx.fillStyle = colors[index % colors.length];
                ctx.fill();
                ctx.stroke();

                // Draw Text
                ctx.save();
                ctx.translate(centerX, centerY);
                ctx.rotate(startAngle + step / 2);
                ctx.textAlign = "right";
                ctx.fillStyle = "#fff";
                ctx.font = "bold 24px Poppins";
                ctx.shadowColor = "rgba(0,0,0,0.3)";
                ctx.shadowBlur = 4;
                // Move text slightly away from edge and center
                ctx.fillText(item.substring(0, 18) + (item.length > 18 ? '..' : ''), radius - 40, 10);
                ctx.restore();
            });
        }

        // Spin Logic
        function spin() {
            if (isSpinning) return;
            if (items.length < 2) {
                alert("Please add at least 2 options!");
                return;
            }

            isSpinning = true;
            spinBtn.disabled = true;
            spinBtn.classList.add('opacity-50');

            // Random rotation between 5 and 10 full spins (360 * 5 to 360 * 10)
            const extraSpins = 360 * (5 + Math.random() * 5); 
            // Add a random offset to land inside a segment
            const randomOffset = Math.floor(Math.random() * 360);
            
            const totalDegrees = currentRotation + extraSpins + randomOffset;
            
            // Apply CSS transition via JS styles isn't smooth for dynamic values, 
            // so we calculate the final angle and set the style.
            wheelContainer.style.transform = `rotate(-${totalDegrees}deg)`;

            // Calculate Winner
            // The arrow is at the TOP (270 degrees or -90 degrees in CSS terms if 0 is right).
            // But our CSS rotation is negative.
            // Let's calculate the actual angle module 360.
            
            setTimeout(() => {
                isSpinning = false;
                spinBtn.disabled = false;
                spinBtn.classList.remove('opacity-50');
                currentRotation = totalDegrees % 360; // Keep the rotation state manageable
                
                // Which index won?
                // The wheel rotated 'totalDegrees'. 
                // The arrow points to TOP. 
                // We need to normalize the rotation to find which segment is at the top.
                
                const actualRotation = totalDegrees % 360;
                const segmentAngle = 360 / items.length;
                
                // Because the arrow is at the top (90 degrees visual, but 0 index starts at right),
                // We have to adjust math carefully. 
                // A simpler way: The pointer is stationary at top.
                // If we rotate the wheel -90deg, index 0 is at top.
                // The formula below approximates the index based on standard unit circle logic adjusted for the CSS rotation.
                
                let winningIndex = Math.floor(((actualRotation + 90) % 360) / segmentAngle);
                // Inverse index because wheel spins clockwise (technically canvas draws clockwise)
                winningIndex = (items.length - 1) - Math.floor(((actualRotation) % 360) / segmentAngle);
                
                // Safety clamp
                if (winningIndex < 0) winningIndex = items.length - 1;
                if (winningIndex >= items.length) winningIndex = 0;

                showWinner(items[winningIndex]);

                // Reset style to current rotation without transition so next spin starts from here
                // Note: To keep CSS transition working, we just keep increasing the value in real app, 
                // but here we just leave it at the high number.
                currentRotation = totalDegrees; 
                
            }, 3000); // 3s matches CSS transition
        }

        function showWinner(text) {
            winnerText.innerText = text;
            resultModal.classList.remove('hidden');
            resultModal.querySelector('div').classList.add('bounce-in');
            
            // Trigger confetti effect (simulated)
            createConfetti();
        }

        // Simple Confetti
        function createConfetti() {
            // Using a canvas overlay or just simple CSS dots could work, 
            // but for a single file, let's just assume the user is happy with the modal bounce.
        }

        // Presets
        const presets = {
            food: "Pizza, Burger, Biryani, Dosa, Chinese, Salad, Khichdi",
            movies: "Action, Comedy, Horror, Sci-Fi, Romance, Thriller",
            activity: "Sleep, Study, Game, Walk, Gym, Read"
        };

        function loadPreset(key) {
            optionsInput.value = presets[key];
            updateBtn.click();
        }

        // Event Listeners
        spinBtn.addEventListener('click', spin);
        
        updateBtn.addEventListener('click', () => {
            parseInput();
            drawWheel();
            // Reset rotation visually if desired, or just keep it
        });

        clearBtn.addEventListener('click', () => {
            optionsInput.value = "";
            parseInput();
            drawWheel();
        });

        closeModal.addEventListener('click', () => {
            resultModal.classList.add('hidden');
        });

        // Initialize
        init();

        // Responsive resize
        window.addEventListener('resize', drawWheel);

    </script>
</body>
</html>

